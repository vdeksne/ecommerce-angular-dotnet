<header class="navbar">
  <div class="navbar-container">
    <!-- Logo -->
    <a
      routerLink="/"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
      class="logo"
    >
      Victoria Dexne
    </a>

    <!-- Right Side Actions -->
    <div class="navbar-actions">
      <!-- Cart (Desktop only) -->
      <a
        routerLink="/cart"
        routerLinkActive="active"
        class="cart-button desktop-cart"
      >
        <span class="cart-text">Cart</span>
        @if ((cartService.itemCount() ?? 0) > 0) {
        <span class="cart-badge">{{ cartService.itemCount() }}</span>
        }
      </a>

      <!-- User Menu -->
      <!-- @if (accountService.currentUser(); as user) {
      <button
        mat-icon-button
        [matMenuTriggerFor]="userMenu"
        class="user-menu-button"
      >
        <span class="user-icon">ğŸ‘¤</span>
      </button>
      } @else {
      <a routerLink="/account/login" class="login-button">Login</a>
      } -->
    </div>

    <!-- Mobile Menu Button -->
    <button
      class="mobile-menu-button"
      (click)="toggleMobileMenu()"
      [attr.aria-expanded]="mobileMenuOpen()"
      aria-label="Toggle menu"
    >
      <span class="hamburger-icon" [class.open]="mobileMenuOpen()">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>
  </div>

  <!-- Mobile Navigation Menu -->
  <nav class="mobile-nav" [class.open]="mobileMenuOpen()">
    <a
      routerLink="/"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Home
    </a>
    <a
      routerLink="/archive"
      routerLinkActive="active"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Archive
    </a>
    <a
      routerLink="/context"
      routerLinkActive="active"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Context
    </a>
    <a
      routerLink="/shop"
      routerLinkActive="active"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Collect
    </a>
    <a
      routerLink="/cart"
      routerLinkActive="active"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Cart @if ((cartService.itemCount() ?? 0) > 0) {
      <span class="mobile-cart-badge">{{ cartService.itemCount() }}</span>
      }
    </a>
    @if (accountService.currentUser(); as user) {
    <a
      routerLink="/orders"
      routerLinkActive="active"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Orders
    </a>
    <button
      class="mobile-nav-link logout-link"
      (click)="logout(); closeMobileMenu()"
    >
      Logout
    </button>
    } @else {
    <a
      routerLink="/account/login"
      class="mobile-nav-link"
      (click)="closeMobileMenu()"
    >
      Login
    </a>
    }
  </nav>
</header>

@if (busyService.loading) {
<mat-progress-bar mode="indeterminate" class="progress-bar"></mat-progress-bar>
}

<mat-menu #userMenu="matMenu" class="user-menu">
  <button mat-menu-item routerLink="/orders">
    <span class="menu-icon">ğŸ“¦</span>
    <span>Orders</span>
  </button>
  <button mat-menu-item routerLink="/account">
    <span class="menu-icon">âš™ï¸</span>
    <span>Account</span>
  </button>
  @if (accountService.currentUser()) {
  <mat-divider></mat-divider>
  <button mat-menu-item routerLink="/admin">
    <span class="menu-icon">ğŸ”§</span>
    <span>Admin</span>
  </button>
  }
  <mat-divider></mat-divider>
  <button mat-menu-item (click)="logout()">
    <span class="menu-icon">ğŸšª</span>
    <span>Logout</span>
  </button>
</mat-menu>
